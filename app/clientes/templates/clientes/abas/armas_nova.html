<!-- Modal Nova Arma -->
<div class="modal fade" id="modalNovaArma" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('clientes.salvar_craf', cliente_id=cliente.id) }}">
        <div class="modal-header">
          <h5 class="modal-title">Cadastrar Nova Arma</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <!-- Tipo + Funcionamento -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="novaTipo">Tipo</label>
              <select id="novaTipo" name="tipo" class="form-select">
                <option value="">Selecione</option>
                {% for val, label in tipos_arma %}
                  <option value="{{ val }}">{{ label }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label for="novaFuncionamento">Funcionamento</label>
              <select id="novaFuncionamento" name="funcionamento" class="form-select">
                <option value="">Selecione</option>
                {% for val, label in funcionamento_arma %}
                  <option value="{{ val }}">{{ label }}</option>
                {% endfor %}
              </select>
            </div>
          </div>

          <!-- Marca + Modelo -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="novaMarca">Marca</label>
              <input type="text" id="novaMarca" name="marca" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label for="novaModelo">Modelo</label>
              <input type="text" id="novaModelo" name="modelo" class="form-control">
            </div>
          </div>

          <!-- Calibre + NÂº SÃ©rie -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="novaCalibre">Calibre</label>
              <input type="text" id="novaCalibre" name="calibre" class="form-control">
            </div>
            <div class="col-md-6 mb-3">
              <label for="novaNumeroSerie">NÃºmero de SÃ©rie</label>
              <input type="text" id="novaNumeroSerie" name="numero_serie" class="form-control">
            </div>
          </div>

          <!-- Emissor + NÂº Sigma -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="novaEmissorCraf">Emissor do CRAF</label>
              <select id="novaEmissorCraf" name="emissor_craf" class="form-select">
                <option value="">Selecione</option>
                {% for val, label in emissores_craf %}
                  <option value="{{ val }}">{{ label }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label for="novaSigma">NÂº Sigma / NÂº do Registro</label>
              <input type="text" id="novaSigma" name="numero_sigma" class="form-control">
            </div>
          </div>

          <!-- Categoria + Validade -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="novaCategoria">Categoria do Adquirente</label>
              <select id="novaCategoria" name="categoria_adquirente" class="form-select">
                <option value="">Selecione</option>
                {% for val, label in categorias_adquirente %}
                  <option value="{{ val }}">{{ label }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label for="novaValidade">Data de Validade</label>
              <input type="date" id="novaValidade" name="data_validade_craf" class="form-control">
              <div class="form-check mt-1">
                <input type="checkbox" id="novaValidadeIndet" name="validade_indeterminada" class="form-check-input">
                <label class="form-check-label" for="novaValidadeIndet">Validade indeterminada</label>
              </div>
            </div>
          </div>

          <!-- Upload CRAF (opcional) -->
          <div class="mb-3">
            <label for="uploadNovaArma">Arquivo CRAF (opcional)</label>
            <input
              type="file"
              id="uploadNovaArma"
              class="form-control"
              accept=".pdf,.jpg,.jpeg,.png"
            >
            <!-- ðŸ”¹ Campo oculto que o JS preenche apÃ³s OCR -->
            <input type="hidden" id="novaCaminhoCraf" name="caminho_craf">
            <small class="text-muted">Se enviado, serÃ¡ processado via OCR para preencher automaticamente os campos.</small>
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Salvar</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>
